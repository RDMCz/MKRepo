# Kongruence a ÄŒÃ­nskÃ¡ vÄ›ta o zbytku

## Kongruence 1. stupnÄ›

Kongruence 1. stupnÄ› jsou ve tvaru ğ‘ğ‘¥ â‰¡ ğ‘ (ğ‘š) a Å™Ã­kajÃ­, Å¾e ğ‘ğ‘¥ a ğ‘ vracÃ­ po vydÄ›lenÃ­ ÄÃ­slem ğ‘š stejnÃ½ zbytek. Pro pÅ™edstavu mÅ¯Å¾e bÃ½t lepÅ¡Ã­ formulace, Å¾e ğ‘ğ‘¥ a ğ‘ se od sebe liÅ¡Ã­ o nÄ›jakÃ½ nÃ¡sobek ÄÃ­sla ğ‘š.

O Å™eÅ¡enÃ­ kongruencÃ­ platÃ­ nÃ¡sledujÃ­cÃ­:

* `ğ‘‘ = NSD(ğ‘,ğ‘š)`
  * `ğ‘‘ = 1` â€“ prÃ¡vÄ› jedno Å™eÅ¡enÃ­
  * `ğ‘‘ â‰  1 âˆ§ ğ‘‘|ğ‘` â€“ ğ‘‘-nÃ¡sobnÃ© Å™eÅ¡enÃ­
  * `ğ‘‘ â‰  1 âˆ§ ğ‘‘âˆ¤ğ‘` â€“ nemÃ¡ Å™eÅ¡enÃ­

Postup vÃ½poÄtu:

* __1.__ Otestovat Å™eÅ¡itelnost
* __2.__ ZjednoduÅ¡it
  * __2a.__ PÅ™i ğ‘‘-nÃ¡sobnÃ©m Å™eÅ¡enÃ­ je nutnÃ© celou rovnici vydÄ›lit ğ‘‘ (levÃ¡ strana, pravÃ¡ strana, modulo)
  * __2b.__ Z levÃ© a/nebo pravÃ© strany odebrat nejvÄ›tÅ¡Ã­ nÃ¡sobek modulu (pro jednonÃ¡sobnÃ© i vÃ­cenÃ¡sobnÃ© Å™eÅ¡enÃ­)
* __3.__ Vyplnit tabulku:

```text
â•”â•â•â•â•¦â•â•â•â•â•¦â•â•â•â•â•—
â•‘ i â•‘ -2 â•‘ -1 â•‘
â• â•â•â•â•¬â•â•â•â•â•¬â•â•â•â•â•£
â•‘ Î“ â•‘ m  â•‘ a  â•‘
â• â•â•â•â•¬â•â•â•â•â•©â•â•â•â•â•£
â•‘ q â•‘         â•‘
â• â•â•â•â•¬â•â•â•â•â•¦â•â•â•â•â•£
â•‘ P â•‘ 0  â•‘ 1  â•‘
â•šâ•â•â•â•©â•â•â•â•â•©â•â•â•â•â•
```

* V tabulce:
  * `i` je inkrementovÃ¡no s kaÅ¾dÃ½m sloupcem
  * `m` a `a` je zÃ­skÃ¡no ze (zjednoduÅ¡enÃ©ho) zadÃ¡nÃ­
  * ğ‘<sub>ğ‘–</sub> je celÃ¡ ÄÃ¡st vÃ½sledku a Î“<sub>ğ‘–</sub> je zbytek po dÄ›lenÃ­ Î“<sub>ğ‘–-2</sub>/Î“<sub>ğ‘–-1</sub>
  * ğ‘ƒ<sub>ğ‘–</sub> = ğ‘<sub>ğ‘–</sub> â‹… ğ‘ƒ<sub>ğ‘–-1</sub> + ğ‘ƒ<sub>ğ‘–-2</sub>
* __4.__ Dosadit hodnoty z tabulky do vzorce ğ‘¥ = (-1)<sup>ğ‘›</sup> â‹… ğ‘ƒ<sub>ğ‘›-1</sub> â‹… ğ‘
  * Za ğ‘› povaÅ¾ujeme poslednÃ­ hodnotu v Å™Ã¡dku `i`
  * ğ‘ƒ<sub>ğ‘›-1</sub> je tedy pÅ™edposlednÃ­ hodnota v Å™Ã¡dku `P`
* __5.__ U ğ‘‘-nÃ¡sobnÃ©ho Å™eÅ¡enÃ­ pÅ™iÄÃ­tat k ğ‘¥ vydÄ›lenÃ½ modul, dokud jich nenÃ­ ğ‘‘
  * Å˜eÅ¡enÃ­ jsou modulovÃ¡na pÅ¯vodnÃ­m modulem (takÅ¾e pokud budeme pÅ™iÄÃ­tat dÃ¡le, zacyklÃ­me se)
* __Kongruence mÃ¡ vÅ¾dy 0 aÅ¾ ğ‘š Å™eÅ¡enÃ­, ale vyhovuje jÃ­ buÄ 0, nebo nekoneÄno ÄÃ­sel__ (viz pÅ™Ã­klad)

### PÅ™Ã­klad kongruence 1. stupnÄ› (jednonÃ¡sobnÃ© Å™eÅ¡enÃ­)

1143ğ‘¥ â‰¡ 22 (500)

* __1.__ Otestujeme Å™eÅ¡itelnost: `ğ‘‘ = NSD(1143,500) = 1` â‡’ mÃ¡ prÃ¡vÄ› jedno Å™eÅ¡enÃ­
* __2b.__ ZjednoduÅ¡Ã­me levou stranu â€“ odebereme nejvÄ›tÅ¡Ã­ nÃ¡sobek modulu:

```text
         1143ğ‘¥ â‰¡ 22 (500)
(2Ã—500 + 143)ğ‘¥ â‰¡ 22 (500)
          143ğ‘¥ â‰¡ 22 (500)
```

* __3.__ VyplnÃ­me tabulku:

```text
â•”â•â•â•â•¦â•â•â•â•â•â•¦â•â•â•â•â•â•—     â•”â•â•â•â•¦â•â•â•â•â•â•¦â•â•â•â•â•â•¦â•â•â•â•â•¦â•â•â•â•â•¦â•â•â•â•â•â•—     â•”â•â•â•â•¦â•â•â•â•â•â•¦â•â•â•â•â•â•¦â•â•â•â•â•¦â•â•â•â•â•¦â•â•â•â•â•â•—
â•‘ i â•‘  -2 â•‘  -1 â•‘     â•‘ i â•‘  -2 â•‘  -1 â•‘  0 â•‘  1 â•‘   2 â•‘     â•‘ i â•‘  -2 â•‘  -1 â•‘  0 â•‘  1 â•‘   2 â•‘ â† ğ‘› = 2
â• â•â•â•â•¬â•â•â•â•â•â•¬â•â•â•â•â•â•£     â• â•â•â•â•¬â•â•â•â•â•â•¬â•â•â•â•â•â•¬â•â•â•â•â•¬â•â•â•â•â•¬â•â•â•â•â•â•£     â• â•â•â•â•¬â•â•â•â•â•â•¬â•â•â•â•â•â•¬â•â•â•â•â•¬â•â•â•â•â•¬â•â•â•â•â•â•£
â•‘ Î“ â•‘ 500 â•‘ 143 â•‘     â•‘ Î“ â•‘ 500 â•‘ 143 â•‘ 71 â•‘  1 â•‘   0 â•‘     â•‘ Î“ â•‘ 500 â•‘ 143 â•‘ 71 â•‘  1 â•‘   0 â•‘
â• â•â•â•â•¬â•â•â•â•â•â•©â•â•â•â•â•â•£  â†’  â• â•â•â•â•¬â•â•â•â•â•â•©â•â•â•â•â•â•¬â•â•â•â•â•¬â•â•â•â•â•¬â•â•â•â•â•â•£  â†’  â• â•â•â•â•¬â•â•â•â•â•â•©â•â•â•â•â•â•¬â•â•â•â•â•¬â•â•â•â•â•¬â•â•â•â•â•â•£
â•‘ q â•‘           â•‘     â•‘ q â•‘           â•‘  3 â•‘  2 â•‘  71 â•‘     â•‘ q â•‘           â•‘  3 â•‘  2 â•‘  71 â•‘
â• â•â•â•â•¬â•â•â•â•â•â•¦â•â•â•â•â•â•£     â• â•â•â•â•¬â•â•â•â•â•â•¦â•â•â•â•â•â•¬â•â•â•â•â•¬â•â•â•â•â•¬â•â•â•â•â•â•£     â• â•â•â•â•¬â•â•â•â•â•â•¦â•â•â•â•â•â•¬â•â•â•â•â•¬â•â•â•â•â•¬â•â•â•â•â•â•£
â•‘ P â•‘   0 â•‘   1 â•‘     â•‘ P â•‘   0 â•‘   1 â•‘    â•‘    â•‘     â•‘     â•‘ P â•‘   0 â•‘   1 â•‘  3 â•‘  7 â•‘ 500 â•‘
â•šâ•â•â•â•©â•â•â•â•â•â•©â•â•â•â•â•â•     â•šâ•â•â•â•©â•â•â•â•â•â•©â•â•â•â•â•â•©â•â•â•â•â•©â•â•â•â•â•©â•â•â•â•â•â•     â•šâ•â•â•â•©â•â•â•â•â•â•©â•â•â•â•â•â•©â•â•â•â•â•©â•â•â•â•â•©â•â•â•â•â•â•
                                                                                    â†‘ ğ‘ƒâ‚™â‚‹â‚ = 7
```

* __4.__ DosadÃ­me do vzorce ğ‘¥ = (-1)<sup>ğ‘›</sup> â‹… ğ‘ƒ<sub>ğ‘›-1</sub> â‹… ğ‘

```text
ğ‘¥ = (-1)Â² â‹… 7 â‹… 22
ğ‘¥ = 154

Kongruence mÃ¡ jedno Å™eÅ¡enÃ­, ale vyhovuje jÃ­ nekoneÄno ÄÃ­sel!
KorektnÃ­ vÃ½sledek rovnice 1143 â‹… ğ‘¥ â‰¡ 22 (500) je tedy ğ‘¥ â‰¡ 154 (500).
```

* __ğ‘¥ â‰¡ 154 (500)__

### PÅ™Ã­klad kongruence 1. stupnÄ› (vÃ­cenÃ¡sobnÃ© Å™eÅ¡enÃ­)

768ğ‘¥ â‰¡ -1240 (412)

* __1.__ Otestujeme Å™eÅ¡itelnost: `ğ‘‘ = NSD(768,412) = 4` â‡’ mÃ¡ 4 Å™eÅ¡enÃ­
* __2a.__ Rovnici je nutnÃ© vydÄ›lit ÄtyÅ™kou: `192ğ‘¥ â‰¡ -310 (103)`
* __2b.__ ZjednoduÅ¡Ã­me strany:

```text
         192ğ‘¥ â‰¡ -310         (103)
(1Ã—103 + 89)ğ‘¥ â‰¡ -(3Ã—103 + 1) (103)
          89ğ‘¥ â‰¡ -1           (103)
```

* __3.__ VyplnÃ­me tabulku:

```text
i     -2      -1       0       1       2       3       4
Î“    103      89      14       5       4       1       0
q                      1       6       2       1       4
P      0       1       1       7      15      22     103
```

* __4.__ DosadÃ­me do vzorce ğ‘¥ = (-1)<sup>ğ‘›</sup> â‹… ğ‘ƒ<sub>ğ‘›-1</sub> â‹… ğ‘

```text
ğ‘¥ = (-1)â´ â‹… 22 â‹… -1
ğ‘¥ = -22 (mod 103)
ğ‘¥ =  81 (mod 103)
```

* __5.__ Å˜eÅ¡enÃ­ pÅ¯vodnÃ­ kongruence je ÄtyÅ™nÃ¡sobnÃ©
  * Å˜eÅ¡enÃ­ vydÄ›lenÃ© kongruence pouÅ¾ijeme pro â€generaciâ€œ Å™eÅ¡enÃ­ v pÅ¯vodnÃ­m modulu
  * `ğ‘¥ = 81 (mod 103)` â‡’ `ğ‘¥ = 81 + 103ğ‘› (mod 412)`

```text
81 + 103(0) =  81 (mod 412)
81 + 103(1) = 184 (mod 412)
81 + 103(2) = 287 (mod 412)
81 + 103(3) = 390 (mod 412)
ğ‘¥ = {81, 184, 287, 390}

Kongruence mÃ¡ ÄtyÅ™i Å™eÅ¡enÃ­, ale vyhovuje jÃ­ nekoneÄno ÄÃ­sel!
KorektnÃ­ vÃ½sledek rovnice 768ğ‘¥ â‰¡ -1240 (412) je tedy:
```

* __ğ‘¥ = {81 + ğ‘˜ğ‘š, 184 + ğ‘˜ğ‘š, 287 + ğ‘˜ğ‘š, 390 + ğ‘˜ğ‘š}, kde (ğ‘š = 412) âˆ§ (ğ‘˜ âˆˆ â„¤)__

### Kongruence bruteforce

* Do kalkulaÄky napÃ­Å¡eme `(ğ‘ Ã— ğ‘¥ - ğ‘) Ã· ğ‘š`
* Za ğ‘¥ postupnÄ› dosazujeme ÄÃ­sla 0 aÅ¾ ğ‘š-1
* Pokud nÃ¡m vyjde vÃ½sledek beze zbytku, pak je ğ‘¥ Å™eÅ¡enÃ­m kongruence
* (PouÅ¾itelnÃ© pro menÅ¡Ã­ moduly)

## Soustavy kongruencÃ­ 1. stupnÄ›

* UvaÅ¾ujeme soustavu kongruencÃ­ tvaru:
  * ğ‘¥ â‰¡ ğ‘â‚ (ğ‘šâ‚)
  * ğ‘¥ â‰¡ ğ‘â‚‚ (ğ‘šâ‚‚)
  * ...
  * ğ‘¥ â‰¡ ğ‘<sub>ğ‘˜</sub> (ğ‘š<sub>ğ‘˜</sub>)
* JednotlivÃ© kongruence jsou tedy tvaru ğ‘ğ‘¥ â‰¡ ğ‘ (ğ‘š), kde ğ‘ = 1
* HledÃ¡me jejich spoleÄnÃ© Å™eÅ¡enÃ­

### Ãšprava do tvaru ğ‘ = 1

* Co s kongruencÃ­, kde ğ‘ â‰  1? NapÅ™.:
  * `21ğ‘¥ â‰¡ 84 (45)`
* Nejprve z levÃ© a/nebo pravÃ© strany odebereme nejvÄ›tÅ¡Ã­ nÃ¡sobek modulu:
  * `21ğ‘¥ â‰¡ 84 (45)` â†’ `21ğ‘¥ â‰¡ 45 + 39 (45)` â†’ `21ğ‘¥ â‰¡ 39 (45)`
* Pokud NSN(ğ‘,ğ‘,ğ‘š) â‰  1, tak jÃ­m celou kongruenci vydÄ›lÃ­me:
  * `21ğ‘¥ â‰¡ 39 (45)` â†’ `7ğ‘¥ â‰¡ 13 (15)`
* NynÃ­ mÃ¡me `7ğ‘¥ â‰¡ 13 (15)` a na levÃ© stranÄ› potÅ™ebujeme samotnÃ© ğ‘¥:
  * HledÃ¡me ÄÃ­slo, kterÃ© po vynÃ¡sobenÃ­ 7 a modulo 15 dÃ¡ 1 (inverznÃ­ prvek k ÄÃ­slu 7 v â„¤<sub>15</sub>)
  * Å˜eÅ¡Ã­me tedy kongruenci `7ğ‘¥ â‰¡ 1 (15)` â†’ `ğ‘¥ â‰¡ 13 (15)`
* VynÃ¡sobÃ­me levou a pravou stranu inverznÃ­m prvkem:
  * `7ğ‘¥ â‹… 13 â‰¡ 13 â‹… 13 (15)` â†’ `91ğ‘¥ â‰¡ 169 (15)` â†’ `ğ‘¥ â‰¡ 4 (15)`

### ÄŒÃ­nskÃ¡ vÄ›ta o zbytku

ÄŒÃ­nskou vÄ›tu o zbytku lze pouÅ¾Ã­t tehdy, pokud jsou jednotlivÃ© moduly kongruencÃ­ po dvou nesoudÄ›lnÃ© (âˆ€ğ‘–â‰ ğ‘— NSD(ğ‘š<sub>ğ‘–</sub>,ğ‘š<sub>ğ‘—</sub>)=1). Pak mÃ¡ soustava pro libovolnÃ© pravÃ© strany ğ‘â‚, ..., ğ‘<sub>ğ‘˜</sub> prÃ¡vÄ› jedno Å™eÅ¡enÃ­ modulo ğ‘€ = ğ‘šâ‚ â‹… ... â‹… ğ‘š<sub>ğ‘˜</sub>. Toto Å™eÅ¡enÃ­ je tvaru:

ğ‘¥ â‰¡ ğ‘¥â‚€ (mod ğ‘€)<br>
ğ‘¥â‚€ â‰¡ ğ‘€â‚<i>MÌ„</i>â‚ğ‘â‚ + ... + ğ‘€â‚<sub>ğ‘˜</sub>_MÌ„_<sub>ğ‘˜</sub>ğ‘<sub>ğ‘˜</sub> (mod ğ‘€)

kde âˆ€ğ‘– platÃ­ (ğ‘€<sub>ğ‘–</sub> = ğ‘€/ğ‘š<sub>ğ‘–</sub>) &ensp; âˆ§ &ensp; (ğ‘€<sub>ğ‘–</sub> â‹… _MÌ„_<sub>ğ‘–</sub> â‰¡ 1 (ğ‘š<sub>ğ‘–</sub>))

```text
NajdÄ›te ğ‘¥ pro
ğ‘¥ â‰¡ 5 (11)
ğ‘¥ â‰¡ 6 (12)
ğ‘¥ â‰¡ 7 (13)

Moduly 11, 12, 13 jsou po dvou nesoudÄ›lnÃ© â‡’ pouÅ¾ijeme ÄÃ­nu
```

![ÄŒÃ­nskÃ¡ vÄ›ta o zbytku](../../svg/discrete/China.png)

KorektnÃ­ vÃ½sledek je tvaru:<br><b>
ğ‘¥ â‰¡ ğ‘¥â‚€ (1716)<br>
ğ‘¥â‚€ â‰¡ 1710 (1716)</b>

### ZobecnÄ›nÃ¡ ÄÃ­nskÃ¡ vÄ›ta o zbytku

ZobecnÄ›nou ÄÃ­nskou vÄ›tu o zbytku mÅ¯Å¾eme pouÅ¾Ã­t, pokud neplatÃ­ podmÃ­nka po dvou nesoudÄ›lnÃ½ch modulÅ¯, ale platÃ­, Å¾e âˆ€ğ‘–â‰ ğ‘— NSD(ğ‘š<sub>ğ‘–</sub>,ğ‘š<sub>ğ‘—</sub>)|(ğ‘<sub>ğ‘–</sub> - ğ‘<sub>ğ‘—</sub>). Pak je jedinÃ© Å™eÅ¡enÃ­ soustavy tvaru:

ğ‘¥ â‰¡ ğ‘â‚ â‹… ğ‘â‚ + ... + ğ‘<sub>ğ‘˜</sub> â‹… ğ‘<sub>ğ‘˜</sub> (mod ğ‘€)

* __ğ‘€__ = NSN(ğ‘šâ‚, ..., ğ‘š<sub>ğ‘˜</sub>)

* __ğ‘<sub>ğ‘–</sub>__ (pro ğ‘– = 1, ..., ğ‘˜) jsou takovÃ¡ ÄÃ­sla, Å¾e:

  * (ğ‘<sub>ğ‘–</sub> â‰¡ 0 (ğ‘€/ğ‘‘<sub>ğ‘–</sub>)) &ensp; âˆ§ &ensp; (ğ‘<sub>ğ‘–</sub> â‰¡ 1 (ğ‘‘<sub>ğ‘–</sub>))
  * â‡’  (ğ‘€/ğ‘‘<sub>ğ‘–</sub>)ğ‘¡ â‰¡ 1 (ğ‘‘<sub>ğ‘–</sub>) &ensp; â‡” &ensp; ğ‘<sub>ğ‘–</sub> = (ğ‘€/ğ‘‘<sub>ğ‘–</sub>)ğ‘¡

* __ğ‘‘<sub>ğ‘–</sub>__ (pro ğ‘– = 1, ..., ğ‘˜) jsou takovÃ¡ ÄÃ­sla, Å¾e:

  * (âˆ€ğ‘–â‰ ğ‘— NSD(ğ‘‘<sub>ğ‘–</sub>,ğ‘‘<sub>ğ‘—</sub>) = 1) &ensp; âˆ§ &ensp; (âˆ€ğ‘– ğ‘‘<sub>ğ‘–</sub>|ğ‘š<sub>ğ‘–</sub>) &ensp; âˆ§ &ensp; (ğ‘‘â‚ â‹… ... â‹… ğ‘‘<sub>ğ‘˜</sub> = ğ‘€)
  * DÃ©Äka jsou po dvou nesoudÄ›lnÃ¡, kaÅ¾dÃ© dÄ›lÃ­ svÅ¯j patÅ™iÄnÃ½ modul a jejich vynÃ¡sobenÃ­m dostaneme ğ‘€

```text
NajdÄ›te ğ‘¥ pro
ğ‘¥ â‰¡ 6 (12)
ğ‘¥ â‰¡ 2 (14)
ğ‘¥ â‰¡ 3 (15)
ğ‘¥ â‰¡ 9 (21)

Moduly 12, 14, 15, 21 nejsou po dvou nesoudÄ›lnÃ© (napÅ™. 12 a 14 jsou soudÄ›lnÃ©) â‡’ pouÅ¾ijeme zobecnÄ›nou ÄÃ­nu

NutnÃ¡ a postaÄujÃ­cÃ­ podmÃ­nka platnosti Å™eÅ¡enÃ­: âˆ€iâ‰ j NSD(ğ‘šáµ¢,ğ‘šâ±¼)|ğ‘áµ¢-ğ‘â±¼, vyuÅ¾Ã­vÃ¡me ğ‘|ğ‘ â‡’ Â±ğ‘|Â±ğ‘:
NSD(ğ‘šâ‚,ğ‘šâ‚‚)|ğ‘â‚-ğ‘â‚‚ â†’ NSD(12,14)|6-2 â†’ 2|4 âœ”
NSD(ğ‘šâ‚,ğ‘šâ‚ƒ)|ğ‘â‚-ğ‘â‚ƒ â†’ NSD(12,15)|6-3 â†’ 3|3 âœ”
NSD(ğ‘šâ‚,ğ‘šâ‚„)|ğ‘â‚-ğ‘â‚„ â†’ NSD(12,21)|6-9 â†’ 3|3 âœ”
NSD(ğ‘šâ‚‚,ğ‘šâ‚ƒ)|ğ‘â‚‚-ğ‘â‚ƒ â†’ NSD(14,15)|2-3 â†’ 1|1 âœ”
NSD(ğ‘šâ‚‚,ğ‘šâ‚„)|ğ‘â‚‚-ğ‘â‚„ â†’ NSD(14,21)|2-9 â†’ 7|7 âœ”
NSD(ğ‘šâ‚ƒ,ğ‘šâ‚„)|ğ‘â‚ƒ-ğ‘â‚„ â†’ NSD(15,21)|3-9 â†’ 3|6 âœ”
â‡’ Soustava mÃ¡ Å™eÅ¡enÃ­
```

![ZobecnÄ›nÃ¡ ÄÃ­nskÃ¡ vÄ›ta o zbytku](../../svg/discrete/ChinaGeneralization.png)

KorektnÃ­ vÃ½sledek je tvaru:<br><b>
ğ‘¥ â‰¡ 198 (420)</b>
