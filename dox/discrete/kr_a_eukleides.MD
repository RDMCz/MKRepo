# KanonickÃ© rozklady a EukleidÅ¯v algoritmus

* KR = kanonickÃ½ rozklad
  * ÄŒÃ­slo zapsanÃ© ve tvaru souÄinu prvoÄÃ­sel
* NSD = nejvÄ›tÅ¡Ã­ spoleÄnÃ½ dÄ›litel
  * NejvÄ›tÅ¡Ã­ ÄÃ­slo, kterÃ© dÄ›lÃ­ vÅ¡echna vstupnÃ­ ÄÃ­sla beze zbytku
  * WolframAlpha: `gcd()`
* NSN = nejmenÅ¡Ã­ spoleÄnÃ½ nÃ¡sobek
  * NejmenÅ¡Ã­ ÄÃ­slo, kterÃ© je beze zbytku dÄ›litelnÃ© vÅ¡emi vstupnÃ­mi ÄÃ­sly
  * WolframAlpha: `lcm()`

## ÄŒÃ­slo â†’ KR

```text
ğ‘ = 15 287 571 = 3Â² â‹… 13Â² â‹… 19 â‹… 23Â²
ğ‘ = 15 923 349 = 3Â² â‹… 13Â² â‹… 19Â² â‹… 29
ğ‘ =  2 880 267 = 3 â‹… 13Â³ â‹… 19 â‹… 23
```

* Bruteforce na kalkulaÄce (hodÃ­ se mÃ­t tabulku prvoÄÃ­sel):
  * Do kalkulaÄky pÅ™edepÃ­Å¡eme `15287571 Ã· ()`; zÃ¡vorky jsou dÅ¯leÅ¾itÃ©, od teÄ vÅ¡e pÃ­Å¡eme do nich
  * ÄŒÃ­slo postupnÄ› zkouÅ¡Ã­me dÄ›lit prvoÄÃ­sly (2, 3, 5, 7, ...), dokud nenajdeme nÄ›jakÃ©, kterÃ© ho dÄ›lÃ­ beze zbytku
  * Pokud je vÃ½sledek dÄ›lenÃ­ beze zbytku, zkusÃ­me jeÅ¡tÄ› mociny prvoÄÃ­sla (ğ‘Â², ğ‘Â³, ...)
  * NechÃ¡me nejvÄ›tÅ¡Ã­ mocninu danÃ©ho ğ‘, kterÃ¡ dÄ›lÃ­ ÄÃ­slo beze zbytku; nynÃ­ mÃ¡me `15287571 Ã· (3Â²)`
  * ZapÃ­Å¡eme krÃ¡t a zkouÅ¡Ã­me dalÅ¡Ã­ prvoÄÃ­sla, opÄ›t nechÃ¡vÃ¡me takovÃ©, aby celÃ½ vÃ½raz vychÃ¡zel beze zbytku a abychom mÄ›li nejvÄ›tÅ¡Ã­ moÅ¾nou mocninu
    * `15287571 Ã· (3Â² Ã— 5)`&emsp;nelze, zkouÅ¡Ã­me dalÅ¡Ã­ prvoÄÃ­slo
    * `15287571 Ã· (3Â² Ã— 7)`&emsp;taky nic
    * `15287571 Ã· (3Â² Ã— 11)`&emsp;stÃ¡le nic
    * `15287571 Ã· (3Â² Ã— 13)`&emsp;nÃ¡lez, zkusÃ­me druhou mocninu
    * `15287571 Ã· (3Â² Ã— 13Â²)`&emsp;zkusÃ­me tÅ™etÃ­ mocninu...
    * `15287571 Ã· (3Â² Ã— 13Â³)`&emsp;to uÅ¾ nelze, nechÃ¡vÃ¡me 13Â² a zkouÅ¡Ã­me dÃ¡le
    * `15287571 Ã· (3Â² Ã— 13Â² Ã— 17)`
    * ...
  * SkonÄÃ­me, jakmile je vÃ½sledek 1: `15287571 Ã· (3Â² Ã— 13Â² Ã— 19 Ã— 23Â²)`
  * Na Casiu po tlaÄÃ­tku â€=â€œ maÄkat Å¡ipku doleva, to nÃ¡s hodÃ­ na konec Å™Ã¡dku
    * NÄ›kterÃ¡ novÄ›jÅ¡Ã­ Casia uÅ¾ majÃ­ funkci kanonickÃ©ho rozkladu zabudovanou (FACT)

### KR â†’ NSD/NSN

```text
ğ‘ = 15 287 571 = 3Â² â‹… 13Â² â‹… 19  â‹… 23Â² 
ğ‘ = 15 923 349 = 3Â² â‹… 13Â² â‹… 19Â²       â‹… 29
ğ‘ =  2 880 267 = 3  â‹… 13Â³ â‹… 19  â‹… 23
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    NSD(ğ‘,ğ‘,ğ‘) = 3  â‹… 13Â² â‹… 19            =           9 633
    NSN(ğ‘,ğ‘,ğ‘) = 3Â² â‹… 13Â³ â‹… 19Â² â‹… 23Â² â‹… 29 = 109 504 871 073
```

* NSD â€“ vynÃ¡sobit ÄÃ­sla, kterÃ¡ se vyskytujÃ­ ve vÅ¡ech rozkladech, a u kaÅ¾dÃ©ho pouÅ¾Ã­t nejmenÅ¡Ã­ mocninu, ve kterÃ© se vyskytuje
* NSN â€“ vynÃ¡sobit ÄÃ­sla, kterÃ¡ se vyskytujÃ­ alespoÅˆ v jednom z rozkladÅ¯, a u kaÅ¾dÃ©ho pouÅ¾Ã­t nejvÄ›tÅ¡Ã­ mocninu, ve kterÃ© se vyskytuje

### KR â†’ PoÄet dÄ›litelÅ¯

UrÄete poÄet vÅ¡ech spoleÄnÃ½ch dÄ›litelÅ¯ ÄÃ­sel ğ‘,ğ‘,ğ‘.

```text
Ï„(NSD(ğ‘,ğ‘,ğ‘)) = Ï„(9633) = 2 â‹… 3 â‹… 2 = 12
```

* PoÄet spoleÄnÃ½ch dÄ›litelÅ¯ vÃ­ce ÄÃ­sel je roven poÄtu dÄ›litelÅ¯ jejich NSD
* Funkce Ï„(ğ‘¥) vracÃ­ poÄet dÄ›litelÅ¯ ÄÃ­sla ğ‘¥ a poÄÃ­tÃ¡ se jako Î (ğ‘š+1), kde ğ‘š jsou mocniny prvoÄÃ­selnÃ©ho rozkladu
* Tedy `9 633 = 3 â‹… 13Â² â‹… 19` â†’ mocniny jsou 1, 2 a 1 â†’ `Î (ğ‘š+1) = (1+1)(2+1)(1+1) = (2)(3)(2) = 12`
* WolframAlpha: `DivisorSigma0(9633)`

### KR â†’ SouÄet dÄ›litelÅ¯

UrÄete souÄet vÅ¡ech spoleÄnÃ½ch dÄ›litelÅ¯ ÄÃ­sel ğ‘,ğ‘,ğ‘.

![$$\mathrm{S(NSD}(a,b,c))=\mathrm{S}(9633)=\frac{3^2-1}{3-1}â‹…\frac{13^3-1}{13-1}â‹…\frac{19^2-1}{19-1}=4â‹…183â‹…20=14640$$](../../svg/discrete/dox-discrete-kr_a_eukleides-060b03ec63.svg)

* SouÄet spoleÄnÃ½ch dÄ›litelÅ¯ vÃ­ce ÄÃ­sel je roven souÄtu dÄ›litelÅ¯ jejich NSD
* Funkce S(ğ‘¥) vracÃ­ poÄet dÄ›litelÅ¯ ÄÃ­sla ğ‘¥ a poÄÃ­tÃ¡ se jako Î ((ğ‘<sup>ğ‘š+1</sup>-1)/(ğ‘-1)), kde ğ‘ jsou ÄÃ­sla prvoÄÃ­selnÃ©ho rozkladu a ğ‘š jsou jejich mocniny
* WolframAlpha: `DivisorSigma1(9633)`

### KR â†’ vÃ½pis vÅ¡ech dÄ›litelÅ¯

VypiÅ¡te vÅ¡echny dÄ›litele ÄÃ­sel ğ‘,ğ‘,ğ‘ vzestupnÄ›.

```text
9633 = 19Â¹ â‹… 13Â² â‹… 3Â¹ â†’ [1 2 1]

[0 0 0] â†’ 19â° â‹… 13â° â‹… 3â° =    1
[0 0 1] â†’ 19â° â‹… 13â° â‹… 3Â¹ =    3
[0 1 0] â†’ 19â° â‹… 13Â¹ â‹… 3â° =   13
[0 1 1] â†’ 19â° â‹… 13Â¹ â‹… 3Â¹ =   39
[0 2 0] â†’ 19â° â‹… 13Â² â‹… 3â° =  169
[0 2 1] â†’ 19â° â‹… 13Â² â‹… 3Â¹ =  507
[1 0 0] â†’ 19Â¹ â‹… 13â° â‹… 3â° =   19
[1 0 1] â†’ 19Â¹ â‹… 13â° â‹… 3Â¹ =   57
[1 1 0] â†’ 19Â¹ â‹… 13Â¹ â‹… 3â° =  247
[1 1 1] â†’ 19Â¹ â‹… 13Â¹ â‹… 3Â¹ =  741
[1 2 0] â†’ 19Â¹ â‹… 13Â² â‹… 3â° = 3211
[1 2 1] â†’ 19Â¹ â‹… 13Â² â‹… 3Â¹ = 9633

1, 3, 13, 19, 39, 57, 169, 247, 507, 741, 3211, 9633
```

* Pro spoleÄnÃ© dÄ›litele vÃ­ce ÄÃ­sel opÄ›t vyuÅ¾ijeme rozklad jejich NSD
* (NezbÃ½vÃ¡ neÅ¾ spoÄÃ­tat vÅ¡echny kombinace mocnin prvoÄÃ­sel z rozkladu v rozsahu 0â€“ğ‘š)
* (PrvoÄÃ­sla si lÃ©pe seÅ™adit sestupnÄ›, vÃ½sledek je pak â€seÅ™azenÄ›jÅ¡Ã­â€œ)

## EukleidÅ¯v algoritmus

Pro ğ‘ = 42 237, ğ‘ = 305 045, ğ‘ = 183 027 urÄete NSD(ğ‘,ğ‘,ğ‘).

* PlatÃ­:
  * NSD(ğ‘,ğ‘,ğ‘) = NSD(NSD(ğ‘,ğ‘),ğ‘)

```text
NSD(ğ‘,ğ‘):       NSD(NSD(ğ‘,ğ‘),ğ‘):
305 045         183 027
 42 237           4 693 â†
  9 386               0
  4 693 â†
      0

NSD(ğ‘,ğ‘,ğ‘) = 4 693
```

* NapÃ­Å¡eme dvÄ› ÄÃ­sla pod sebe (vÄ›tÅ¡Ã­ nahoru) a vydÄ›lÃ­me je, zbytek po dÄ›lenÃ­ napÃ­Å¡eme na dalÅ¡Ã­ Å™Ã¡dek; opakujeme pro spodnÃ­ dvÄ› ÄÃ­sla, dokud nedostaneme zbytek 0; poslednÃ­ nenulovÃ½ zbytek je NSD

### NSD â†’ NSN

* PlatÃ­:
  * NSN(ğ‘,ğ‘) = (ğ‘ â‹… ğ‘) / __NSD__(ğ‘,ğ‘)
  * NSN(ğ‘,ğ‘,ğ‘) = NSN(NSN(ğ‘,ğ‘),ğ‘)

```text
     NSN(ğ‘,ğ‘,ğ‘) â†’ NSN(42237,305045,183027) = ?

       NSN(ğ‘,ğ‘) â†’ NSN(42237,305045) = (42237 â‹… 305045) / 4693 = 2745405

NSN(NSN(ğ‘,ğ‘),ğ‘) â†’ ? = NSN(2745405,183027)

2 745 405
  183 027 â†     â‡’    NSD(2745405,183027) = 183027
        0       â‡’ ? = (2745405 * 183027) / 183027 = 2745405

NSN(ğ‘,ğ‘,ğ‘) = 2745405
```
